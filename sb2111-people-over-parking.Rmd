---
title: "The Illinois People Over Parking Act"
author: "Michael McLean - Member, Abundant Housing Illinois"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output_file: "docs/index.html"
output:
  html_document:
    theme: flatly
    toc: false
    self_contained: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

Note: The People Over Parking Act was made possible by the volunteers of [Abundant Housing Illinois](https://abundanthousingillinois.org/). Please consider joining as a member if you are interested in organizing for more land use reform in Illinois.

### What Are Parking Mandates?

Parking mandates, also known as parking minimums, are zoning regulations that require developers to build a minimum number of parking spaces with new housing and commercial developments. These mandates typically specify a certain number of parking spaces per unit of housing, square footage of retail space, or other metrics depending on the development type.

#### Why Parking Mandates Are Costly:

-   **Increased Housing Costs**: Each parking space can cost \$30,000-\$75,000 to build, significantly raising the cost of housing development and ultimately housing prices.
-   **Reduced Housing Supply**: Land used for parking cannot be used for additional housing units, limiting the overall housing supply.
-   **Environmental Impact**: Excessive parking encourages car dependency, increasing traffic congestion and carbon emissions.
-   **Inefficient Land Use**: Parking lots create "dead spaces" in urban areas that could otherwise be used for housing, businesses, or public spaces.
-   **Economic Burden**: Many parking spaces sit empty much of the time, representing wasted resources and opportunity costs.

#### Why Parking Mandates Should Be Repealed:

-   **Market-Based Solutions**: Developers can better determine the appropriate amount of parking based on actual demand rather than arbitrary requirements.
-   **Transit-Oriented Development**: Eliminating parking mandates near transit encourages development that leverages existing public transportation infrastructure.
-   **Affordability**: Reducing or eliminating parking requirements can make housing more affordable and accessible.
-   **Sustainability**: Less parking promotes walking, cycling, and public transit use, reducing carbon emissions.
-   **Vibrant Communities**: Space previously dedicated to parking can be repurposed for housing, businesses, and community amenities.

### Enter: The People Over Parking Act

```{r packages, results='hide'}
# Set CRAN mirror
options(repos = c(CRAN = "https://cloud.r-project.org/"))

# Install packages if not already installed
required_packages <- c("tidyverse", "sf", "lwgeom", "leaflet", "leaflet.extras",
                       "data.table", "zip", "httr", "lubridate", "mapview", "tigris", "kableExtra")

new_packages <- required_packages[!required_packages %in% installed.packages()[,"Package"]]
if(length(new_packages)) install.packages(new_packages)

# Load required packages
library(tidyverse)
library(sf)
library(leaflet)
library(lwgeom)
library(leaflet.extras)
library(data.table)
library(zip)
library(httr)
library(lubridate)
library(mapview)
library(tigris) # For Illinois state boundary
library(kableExtra) # Added for enhanced table formatting

# Disable s2 processing to avoid geometry validation issues
sf_use_s2(FALSE)

# Load Illinois state boundary for clipping transit areas
illinois_boundary <- states(cb = TRUE, year = 2023) %>%
  filter(STUSPS == "IL") %>%
  st_transform(4326)  # Transform to WGS84
```

```{r load_existing_data, results='hide'}
## Load Existing Hub Data and Corridor Data

# Load the existing hub processing results (from the original analysis)
# We'll reuse the hub identification logic from the original script

# Load GTFS utility functions from extracted modules
source("R/agency_metadata.R")  # Centralized agency configuration
source("R/gtfs_download.R")
source("R/gtfs_normalize.R")
source("R/gtfs_validate.R")
source("R/gtfs_processing.R")
source("R/spatial_validate.R")
source("R/spatial_clustering.R")
source("R/frequency_calc.R")
source("R/hub_identification.R")
source("R/hub_processing.R")
source("R/corridor_processing.R")
source("R/buffer_processing.R")
source("R/map_creation.R")
source("R/summary_stats.R")
```

```{r download_gtfs, results='hide'}
## Download and Process GTFS Data

# Get agency configurations from centralized metadata
# Now includes all 14 Illinois transit agencies (6 existing + 8 new)
agency_configs <- get_agency_configs_for_download()

# Process all GTFS data: download, normalize, validate, and combine
gtfs_data <- process_all_gtfs_data(agency_configs, validate = TRUE)

# Extract combined tables for easy access
all_stops <- gtfs_data$all_stops
all_routes <- gtfs_data$all_routes
all_trips <- gtfs_data$all_trips
all_stop_times <- gtfs_data$all_stop_times
all_calendar <- gtfs_data$all_calendar
all_calendar_dates <- gtfs_data$all_calendar_dates
all_shapes <- gtfs_data$all_shapes
validation_results <- gtfs_data$validation_results

# Individual agency data available via gtfs_data$agency_data[[agency_id]]
# Legacy assignments kept for backward compatibility:
cta_data <- gtfs_data$agency_data$cta
pace_data <- gtfs_data$agency_data$pace
metra_data <- gtfs_data$agency_data$metra
metro_stl_data <- gtfs_data$agency_data$metro_stl
cumtd_data <- gtfs_data$agency_data$cumtd
rmtd_data <- gtfs_data$agency_data$rmtd
# New agencies (8):
metrolink_quad_cities_data <- gtfs_data$agency_data$metrolink_quad_cities
citylink_data <- gtfs_data$agency_data$citylink
smtd_data <- gtfs_data$agency_data$smtd
dekalb_data <- gtfs_data$agency_data$dekalb
connect_transit_data <- gtfs_data$agency_data$connect_transit
dpts_data <- gtfs_data$agency_data$dpts
galesburg_data <- gtfs_data$agency_data$galesburg
gowest_data <- gtfs_data$agency_data$gowest
```

```{r explore_direction_data, results='hide'}
## Explore direction_id availability in GTFS data

# Check if direction_id exists in trips data
cat("=== Checking direction_id availability ===\n\n")

# Iterate over all agencies dynamically
all_agency_ids <- get_all_agency_ids()
for (agency_id in all_agency_ids) {
  trips_data <- gtfs_data$agency_data[[agency_id]]$trips
  agency_name <- get_agency_display_name(agency_id)

  if ("direction_id" %in% names(trips_data)) {
    cat(sprintf("%s: Has direction_id field\n", agency_name))
    cat(sprintf("  - Total trips: %d\n", nrow(trips_data)))
    cat(sprintf("  - Trips with direction_id: %d\n", sum(!is.na(trips_data$direction_id))))
    cat(sprintf("  - Unique direction values: %s\n",
                paste(sort(unique(trips_data$direction_id)), collapse = ", ")))
  } else {
    cat(sprintf("%s: NO direction_id field\n", agency_name))
  }
  cat("\n")
}

# If direction_id exists in any agency, ensure it exists in all and rebuild all_trips
has_direction_id <- any(sapply(all_agency_ids, function(agency_id) {
  "direction_id" %in% names(gtfs_data$agency_data[[agency_id]]$trips)
}))

if (has_direction_id) {
  # Ensure direction_id exists in all agency datasets (add NA if missing)
  for (agency_id in all_agency_ids) {
    agency_data <- gtfs_data$agency_data[[agency_id]]
    if (!"direction_id" %in% names(agency_data$trips)) {
      agency_data$trips[, direction_id := NA_integer_]
    }
  }

  # Rebuild all_trips with direction_id from all agencies dynamically
  all_trips_list <- lapply(all_agency_ids, function(agency_id) {
    gtfs_data$agency_data[[agency_id]]$trips
  })
  all_trips <- rbindlist(all_trips_list, fill = TRUE)

  cat("direction_id added to all_trips\n")
  cat(sprintf("Trips with direction_id: %d / %d (%.1f%%)\n",
              sum(!is.na(all_trips$direction_id)),
              nrow(all_trips),
              100 * sum(!is.na(all_trips$direction_id)) / nrow(all_trips)))
}
```

```{r process_hubs_UPDATED, results='hide'}
## Identify Public Transportation Hubs

# Identify all transit hubs (rail stations + qualifying bus hubs)
hub_results <- identify_all_hubs(
  all_stops, all_routes, all_trips,
  all_stop_times, all_calendar, all_calendar_dates
)

# Extract results
all_hubs_sf <- hub_results$all_hubs_sf
am_peak_bus_stops <- hub_results$am_peak_bus_stops
pm_peak_bus_stops <- hub_results$pm_peak_bus_stops

# Filter hubs to only those within Illinois boundary
# This excludes St. Louis metro stations in Missouri
all_hubs_sf <- st_intersection(all_hubs_sf, illinois_boundary)
cat(sprintf("Hubs after filtering to Illinois boundary: %d\n", nrow(all_hubs_sf)))
```

```{r process_corridors_and_buffers, results='hide'}
## Identify Corridors and Create Buffers

# Identify qualifying transit corridors (direction-aware combined frequency)
corridor_results <- identify_qualifying_corridors(
  all_stops, am_peak_bus_stops, pm_peak_bus_stops,
  all_trips, all_shapes
)

qualifying_corridor_shapes_sf <- corridor_results$qualifying_corridor_shapes
corridor_qualification_summary <- corridor_results$qualification_summary

# Create corridor buffers (1/8 mile along actual route geometry from GTFS shapes)
all_corridors_union_wgs84 <- create_corridor_buffers(
  qualifying_corridor_shapes_sf,
  illinois_boundary
)

# Create hub buffers (1/2 mile around hubs)
hub_buffers <- create_hub_buffers(all_hubs_sf, illinois_boundary)

# Extract hub buffer components for area calculations
all_hub_areas_wgs84 <- hub_buffers$all_hub_areas
half_mile_buffers_wgs84 <- hub_buffers$half_mile_buffers

# Legacy hub unions (backward compatibility)
cta_hubs_union <- hub_buffers$cta_hubs_union
pace_hubs_union <- hub_buffers$pace_hubs_union
metra_hubs_union <- hub_buffers$metra_hubs_union
metro_stl_hubs_union <- hub_buffers$metro_stl_hubs_union
cumtd_hubs_union <- hub_buffers$cumtd_hubs_union
rmtd_hubs_union <- hub_buffers$rmtd_hubs_union

# New agencies available via hub_buffers$per_agency_union[[agency_id]]

# Combine all affected areas (hubs + corridors)
all_affected_areas_combined <- create_combined_buffers(
  all_hub_areas_wgs84, all_corridors_union_wgs84, illinois_boundary
)
```

```{r calculate_areas, results='hide'}
## Calculate Areas

# Calculate areas in square miles
hub_area_sqft <- st_area(all_hub_areas_wgs84)
hub_area_sqmi <- units::set_units(hub_area_sqft, "mi^2")

corridor_area_sqft <- st_area(all_corridors_union_wgs84)
corridor_area_sqmi <- units::set_units(corridor_area_sqft, "mi^2")

combined_area_sqft <- st_area(all_affected_areas_combined)
combined_area_sqmi <- units::set_units(combined_area_sqft, "mi^2")

# Total area covered by analysis
# Chicago MSA (6 IL counties): Cook: 953.6, DuPage: 336.5, Kane: 524.2, Lake: 470, McHenry: 611, Will: 849.2
# St. Louis MSA (3 IL counties): St. Clair: 674.6, Madison: 741.5, Monroe: 398.2
# Champaign-Urbana: Champaign County: 1,008
# Rockford: Winnebago County: 519
chicago_il_msa_area_sqmi <- 953.6 + 336.5 + 524.2 + 470 + 611 + 849.2
stlouis_il_msa_area_sqmi <- 674.6 + 741.5 + 398.2
champaign_area_sqmi <- 1008
rockford_area_sqmi <- 519
total_il_area_sqmi <- chicago_il_msa_area_sqmi + stlouis_il_msa_area_sqmi + champaign_area_sqmi + rockford_area_sqmi

# Calculate percentages (against total IL area covered)
pct_hubs <- as.numeric(hub_area_sqmi) / total_il_area_sqmi * 100
pct_corridors <- as.numeric(corridor_area_sqmi) / total_il_area_sqmi * 100
pct_combined <- as.numeric(combined_area_sqmi) / total_il_area_sqmi * 100

# Count hubs and routes
hub_counts <- table(all_hubs_sf$agency_name)
qualifying_corridor_shape_count <- nrow(qualifying_corridor_shapes_sf)
```

```{r create_map}
# Create the interactive map (now with dynamic agency handling)
invisible(capture.output(
  map <- create_interactive_map(
    all_hubs_sf,
    all_affected_areas_combined,
    hub_buffers,  # Now accepts full buffer object
    all_corridors_union_wgs84,
    illinois_boundary,  # Add Illinois state outline
    center_lng = -87.6079,
    center_lat = 41.8917,
    zoom = 9
  )
))

# Display the map
map
```

```{r summary_stats, include=FALSE}
# Generate all summary statistics
stats <- generate_summary_statistics(all_hubs_sf, qualifying_corridor_shapes_sf)

# Extract summary variables for use in inline R code
bus_hub_summary <- stats$bus_hub_summary
corridor_summary <- stats$corridor_summary
rail_hub_count <- stats$rail_hub_count
total_hubs <- stats$total_hubs
cta_hub <- stats$cta_hub
pace_hub <- stats$pace_hub
metro_stl_hub <- stats$metro_stl_hub
cumtd_hub <- stats$cumtd_hub
rmtd_hub <- stats$rmtd_hub
cta_corridor <- stats$cta_corridor
pace_corridor <- stats$pace_corridor
metro_stl_corridor <- stats$metro_stl_corridor
cumtd_corridor <- stats$cumtd_corridor
rmtd_corridor <- stats$rmtd_corridor
rail_hub_counts <- stats$rail_hub_counts
qualifying_bus_hubs <- stats$qualifying_bus_hubs
rail_stops <- stats$rail_stops
qualifying_corridor_shapes <- stats$qualifying_corridor_shapes
```

### Summary Statistics

```{r agency_summary_table, echo=FALSE}
# Calculate per-agency relief areas
agency_metadata <- get_agency_metadata()
agency_ids <- get_all_agency_ids()

# Build summary table
agency_summary <- data.frame(
  Agency = character(),
  `Bus Hubs` = integer(),
  `Rail Hubs` = integer(),
  `Bus Stops in Hubs` = integer(),
  `Relief Area (sq mi)` = numeric(),
  stringsAsFactors = FALSE,
  check.names = FALSE
)

for (agency_id in agency_ids) {
  # Get display name
  agency_name <- get_agency_display_name(agency_id)

  # Bus hubs count
  bus_hubs <- if (agency_id %in% bus_hub_summary$agency) {
    bus_hub_summary[bus_hub_summary$agency == agency_id, ]$unique_clusters
  } else {
    0
  }

  # Rail hubs count
  rail_hubs <- if (agency_id %in% names(rail_hub_counts)) {
    as.integer(rail_hub_counts[agency_id])
  } else {
    0
  }

  # Bus stops in hubs
  bus_stops <- if (agency_id %in% bus_hub_summary$agency) {
    bus_hub_summary[bus_hub_summary$agency == agency_id, ]$total_stops
  } else {
    0
  }

  # Calculate relief area for this agency
  if (agency_id %in% names(hub_buffers$per_agency_union)) {
    agency_buffer <- hub_buffers$per_agency_union[[agency_id]]
    area_sqmi <- as.numeric(units::set_units(st_area(agency_buffer), "mi^2"))
  } else {
    area_sqmi <- 0
  }

  # Add row to summary table
  agency_summary <- rbind(agency_summary, data.frame(
    Agency = agency_name,
    `Bus Hubs` = bus_hubs,
    `Rail Hubs` = rail_hubs,
    `Bus Stops in Hubs` = bus_stops,
    `Relief Area (sq mi)` = area_sqmi,
    stringsAsFactors = FALSE,
    check.names = FALSE
  ))
}

# Add totals row
agency_summary <- rbind(agency_summary, data.frame(
  Agency = "**TOTAL**",
  `Bus Hubs` = sum(agency_summary$`Bus Hubs`),
  `Rail Hubs` = sum(agency_summary$`Rail Hubs`),
  `Bus Stops in Hubs` = sum(agency_summary$`Bus Stops in Hubs`),
  `Relief Area (sq mi)` = sum(agency_summary$`Relief Area (sq mi)`),
  stringsAsFactors = FALSE,
  check.names = FALSE
))

# Format and display table
knitr::kable(
  agency_summary,
  format = "html",
  align = c("l", "r", "r", "r", "r"),
  digits = 2,
  format.args = list(big.mark = ","),
  caption = "Transit Agency Summary: People Over Parking Act Impact"
) %>%
  kableExtra::kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    position = "left"
  ) %>%
  kableExtra::row_spec(nrow(agency_summary), bold = TRUE, background = "#f0f0f0")
```

This analysis examines the potential impact of new legislation passed in Illinois (SB2111) on Chicagoland.

According to the updated bill [10400SB2111ham003](https://www.ilga.gov/documents/legislation/104/SB/PDF/10400SB2111ham003.pdf), minimum parking requirements are prohibited for development projects located within:

- **1/2 mile of public transportation hubs**, defined as:
  - (i) A rail transit station
  - (ii) A boat or ferry terminal served by either a bus connection stop or rail transit station
  - (iii) An intersection of 2 or more bus routes with a **combined frequency** of service interval of 15 minutes or less during peak commute periods

- **1/8 mile of public transportation corridors**, defined as:
  - A street on which there is **one or more bus routes** with a **combined frequency** of bus service interval of 15 minutes or less during the morning and afternoon peak commute periods

### Methodology

This analysis implements the following methodology to identify qualifying transit hubs and corridors:

**Peak Period Definition:**

-   Morning peak: 7:00 AM - 9:00 AM (120 minutes)
-   Afternoon peak: 4:00 PM - 6:00 PM (120 minutes)
-   Service is analyzed separately for each period; locations qualify if they meet frequency thresholds in **either** AM **or** PM

**Stop Clustering (Bus Hubs Only):**

-   Bus stops within **150 feet** of each other are spatially clustered to represent physical intersections
-   This prevents overcounting stops at the same street corner and aligns with the statutory concept of "an intersection of 2 or more bus routes"
-   Clustering uses Illinois State Plane East projection (EPSG:3435) for accurate distance measurement

**Route Overlap Verification (Bus Hubs Only):**

-   After clustering, we verify that routes actually overlap at the same physical intersection or street
-   Stop names (e.g., "Jackson & Lotus", "Oak Ave & Davis St") are parsed to extract street names
-   A cluster qualifies only if **2 or more routes share at least one common street name**
-   This helps ensure routes truly intersect at the location, not just have nearby stops within 150 feet
-   Example: Route A stops at "State & Madison", Route B stops at "State & Monroe" (both within 150ft) → they share "State" street → overlap verified

**Combined Frequency Calculation (Hubs + Corridors):**

-   For each stop cluster (hub) we count unique weekday trips during the AM and PM peaks
-   For corridors we first map trips to their GTFS shapes and split those shapes into **directional segments** that represent the exact portion of a street where one or more routes actually overlap
-   **Direction-aware**: Trips are always summed separately by direction (e.g., northbound vs southbound) so opposite-direction service never inflates frequency
-   Combined service interval = peak period duration (120 min) ÷ total trips in that direction
-   Example: Route A (4 northbound AM trips) + Route B (4 northbound AM trips) on the same northbound street segment = 8 northbound AM trips → 120 ÷ 8 = **15 minute combined interval**

**Qualification Criteria:**

-   **Bus Hubs**: Must have **2 or more routes** AND **combined frequency ≤ 15 minutes** in at least one peak period AND **routes must overlap on same street/intersection**
-   **Bus Corridors**: Must have **1 or more routes** AND **direction-aware combined frequency ≤ 15 minutes** in at least one peak period
  - Routes on the same street that individually don't qualify may qualify together if their combined frequency meets the threshold
  - Directions are kept separate (northbound and southbound are not combined)
  - A corridor qualifies if **any direction in any peak period** has combined frequency ≤15 minutes
-   **Rail Hubs**: All rail stations within Illinois automatically qualify (CTA rail, Metra, and Metro St. Louis MetroLink)

**Direction Handling:**

-   If GTFS `direction_id` data is available, routes are analyzed by direction (northbound/southbound, eastbound/westbound)
-   For corridors, when multiple routes overlap on the same street:
  - Trips are summed across routes **within each direction** (e.g., all northbound trips together)
  - This reflects actual transit availability: if you're waiting for a northbound bus, you can take any northbound route
  - Opposite directions are never combined (bi-directional service is kept separate)

**Corridor Identification & Buffering Workflow:**

1. **Directional trip metrics:** For every route we count unique trips by direction (when available) during the AM and PM peaks and attach those counts to the GTFS shape used by the trip.
2. **Geometry preparation:** Shapes are converted to LINESTRING geometries in Illinois State Plane feet. An optional simplification step (default tolerance = 5 feet) removes redundant vertices while keeping alignment with the street network.
3. **Segment segmentation:** Within each agency and direction we split shapes into minimal segments:
   - Segments used by only a single route remain intact (no expensive overlap processing).
   - Where multiple routes share the same roadway the combined geometry is "noded" (via `lwgeom::st_node`) so every overlapping stretch becomes its own segment.
4. **Directional aggregation:** For each segment we sum trips across the covering routes **within the same direction** and compute AM/PM headways. Only the segments where any direction in either peak has headway ≤ 15 minutes qualify as corridors.
5. **Buffering:** Qualified segments are buffered by **680 feet** (660 ft = 1/8 mile from curb + 20 ft half street width) and clipped to the Illinois boundary.

This segment-based approach means:

- Only the exact portions of streets with combined frequent service are buffered.
- Overlaps count only where they physically occur — a route that briefly shares a street with another inherits the combined frequency **only** on the shared blocks.
- Performance improves because large, non-overlapping shapes skip the intersection-heavy processing entirely.
- Geometry simplification keeps computation tractable while staying within a 5-foot tolerance (set to 0 for maximum fidelity if needed).

Street-width assumptions remain unchanged: 20 feet is a conservative half-width that covers most Illinois street types (local and arterial) per AASHTO guidance.

**Geographic Boundaries and Clipping:**

-   All transit hub and corridor buffers are clipped to Illinois state boundaries
-   This ensures parking mandate relief applies only to areas within Illinois jurisdiction
-   Metro St. Louis transit system operates across the Illinois-Missouri border; only Illinois portions of hub/corridor buffers are included in the analysis
-   Metra serves some stations in Wisconsin (Kenosha County); these are excluded from the analysis (latitude filter at 42.5°)
-   Clipping is performed after buffer creation using the U.S. Census TIGER/Line state boundary for Illinois

### Statutory Interpretation and Ambiguities

Senate Bill 2111 contains three ambiguities that significantly affect which areas qualify for parking minimum relief. Depending on interpretation, **entire cities could be included or excluded from parking reform** under this legislation.

**1. "Intersecting routes"**: The statute refers to "an intersection of 2 or more bus routes" but does not specify whether this means routes that physically cross each other at a road intersection, or whether it includes routes that overlap on the same street without crossing. **Our interpretation**: Routes must serve stops at the same street intersection (verified through spatial clustering within 150 feet combined with street name matching). Alternative interpretations counting parallel routes on the same street would dramatically expand qualifying areas.

**2. "Combined frequency"**: The statute specifies "combined frequency of service interval" but does not define how frequencies from multiple routes should be combined. Should two routes with 30-minute headways be considered as 30-minute combined service, or 15-minute combined service? **Our interpretation**: We sum total trips across all routes during peak periods in a direction-aware manner (e.g., two routes with 30-minute northbound frequency = 4 northbound trips/hour each = 8 northbound trips/hour = 15-minute combined northbound interval). For corridors, routes sharing the same street geometry qualify together if their combined frequency (within each direction) meets the threshold, and we split those geometries into directional segments so the combined headway only applies to the exact blocks where routes overlap. Alternative interpretations using averaged frequencies or minimum headways would result in substantially fewer qualifying locations.

**3. Stop clustering and directionality**: The statute does not specify whether routes must share the exact same stop_id to qualify as "intersecting," or whether nearby stops serving the same intersection should be grouped together. It also does not address whether opposite-direction service should be counted separately or combined. **Our interpretation**: We cluster stops within 150 feet that serve the same street intersection, and when GTFS direction_id data is available, we analyze routes by direction to avoid double-counting bidirectional service. Alternative interpretations requiring exact stop_id matches would exclude many legitimate transit hubs where routes serve nearby stops at the same intersection.

**Legal implications**: Municipalities and courts may interpret these provisions differently, leading to variation in the geographic extent of parking minimum relief across Illinois. This analysis represents one reasonable interpretation aligned with the statute's apparent intent to promote transit-oriented development in areas with genuine high-frequency transit service.

### Data Sources

**Transit Data (GTFS Feeds):**

This analysis incorporates **14 transit agencies** covering major urban areas across Illinois:

-   **Chicago Metro Area:**
    -   CTA (Chicago Transit Authority) - Rail + Bus
    -   Pace Suburban Bus
    -   Metra Commuter Rail
-   **Metro-East (Illinois portion):**
    -   Metro St. Louis (MetroLink Light Rail + MetroBus)
        -   Note: Operates in both Missouri and Illinois; only Illinois portions included after geographic clipping
-   **Champaign-Urbana:** CUMTD (Champaign-Urbana Mass Transit District)
-   **Rockford:** RMTD (Rockford Mass Transit District)
-   **Quad Cities:** MetroLINK (Rock Island County Metropolitan Mass Transit District)
-   **Peoria:** CityLink (Greater Peoria Mass Transit District)
-   **Springfield:** SMTD (Sangamon Mass Transit District)
-   **Bloomington-Normal:** Connect Transit
-   **DeKalb:** DeKalb Public Transit
-   **Decatur:** DPTS (Decatur Public Transit System)
-   **Galesburg:** Galesburg Transit
-   **Macomb:** Go West Transit (Macomb McDonough County Public Transportation)

**Geographic Data:**

-   GTFS shapes.txt from all 14 agencies (actual transit route geometry)
-   Illinois state boundary via TIGER/Line (tigris package)

**Counties Covered:**

The analysis includes **14 Illinois counties** across major urban areas: - **Chicago Metro:** Cook, DuPage, Kane, Lake, McHenry, Will - **Metro-East:** St. Clair - **Central Illinois:** Champaign, McLean, Peoria, Sangamon, Macon - **Northern Illinois:** Winnebago, DeKalb, Rock Island - **Western Illinois:** Knox, McDonough
